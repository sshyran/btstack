<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1841" height="747" contentScriptType="application/ecmascript" contentStyleType="text/css" preserveAspectRatio="none" style="width:1841px;height:747px" version="1.1" viewBox="0 0 1841 747" zoomAndPan="magnify"><defs><filter id="ficsatr1k5q0d" width="300%" height="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text x="712.5" y="26.708" fill="#000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="414">Mandatory Authentication in Peripheral Role</text><ellipse cx="821.563" cy="40.953" fill="#000" filter="url(#ficsatr1k5q0d)" rx="10" ry="10" style="stroke:none;stroke-width:1"/><rect width="385" height="33.969" x="629.063" y="70.953" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="643.063" y="92.092" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="361">App calls gatt_client_set_required_security_level (level &gt; 0)</text><rect width="166" height="33.969" x="738.563" y="124.922" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="752.563" y="146.06" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142">App on B connects to A</text><rect width="254" height="33.969" x="694.563" y="178.891" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="708.563" y="200.029" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="230">App on A triggers GATT Client request</text><rect width="173" height="33.969" x="735.063" y="232.859" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="749.063" y="253.998" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="149">GATT Client request sent</text><polygon fill="#FEFECE" points="780.563 286.828 862.563 286.828 874.563 298.828 862.563 310.828 780.563 310.828 768.563 298.828 780.563 286.828" filter="url(#ficsatr1k5q0d)" style="stroke:#a80036;stroke-width:1.5"/><text x="780.563" y="302.636" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82">LTK available?</text><text x="747.563" y="296.234" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21">yes</text><text x="874.563" y="296.234" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14">no</text><rect width="235" height="33.969" x="282.5" y="320.828" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="296.5" y="341.967" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="211">SM_EVENT_REENCRYPTION_STARTED</text><rect width="233" height="33.969" x="283.5" y="374.797" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="297.5" y="395.935" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="209">SM on A sends SECURITY REQUEST</text><rect width="330" height="33.969" x="235" y="428.766" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="249" y="449.904" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="306">SM on B should encrypt connection if LTK available</text><polygon fill="#FEFECE" points="363 482.734 437 482.734 449 494.734 437 506.734 363 506.734 351 494.734 363 482.734" filter="url(#ficsatr1k5q0d)" style="stroke:#a80036;stroke-width:1.5"/><text x="363" y="498.543" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="74">re-encrypted</text><text x="330" y="492.14" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21">yes</text><text x="449" y="492.14" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14">no</text><rect width="393" height="33.969" x="11" y="516.734" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="25" y="537.873" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="369">SM_EVENT_REENCRYPTION_COMPLETE(ERROR_CODE_SUCCESS)</text><rect width="173" height="33.969" x="121" y="570.703" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="135" y="591.842" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="149">GATT Client request sent</text><rect width="204" height="33.969" x="105.5" y="639.672" fill="#23DB2B" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="119.5" y="660.811" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="180">App receives GATT Response</text><ellipse cx="207.5" cy="719.641" fill="#FFF" filter="url(#ficsatr1k5q0d)" rx="11" ry="11" style="stroke:#000;stroke-width:1"/><ellipse cx="207.5" cy="719.641" fill="#000" rx="6" ry="6" style="stroke:#7f7f7f;stroke-width:1"/><rect width="284" height="33.969" x="450.5" y="516.734" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="464.5" y="537.873" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="260">SM_EVENT_REENCRYPTION_COMPLETE(error)</text><rect width="337" height="47.938" x="424" y="570.703" fill="#FD5B41" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="438" y="591.842" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="267">App receives GATT_QUERY_COMPLETE event</text><text x="454" y="605.811" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="297">with ATT_ERROR_BONDING_INFORMATION_MISSING</text><ellipse cx="592.5" cy="664.641" fill="#FFF" filter="url(#ficsatr1k5q0d)" rx="11" ry="11" style="stroke:#000;stroke-width:1"/><ellipse cx="592.5" cy="664.641" fill="#000" rx="6" ry="6" style="stroke:#7f7f7f;stroke-width:1"/><rect width="194" height="33.969" x="1146.125" y="320.828" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="1160.125" y="341.967" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="170">SM_EVENT_PAIRING_STARTED</text><rect width="233" height="33.969" x="1126.625" y="374.797" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="1140.625" y="395.935" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="209">SM on A sends SECURITY REQUEST</text><rect width="279" height="33.969" x="1103.625" y="428.766" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="1117.625" y="449.904" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="255">SM on B should perform pairing sequence</text><polygon fill="#FEFECE" points="1196.625 482.734 1289.625 482.734 1301.625 494.734 1289.625 506.734 1196.625 506.734 1184.625 494.734 1196.625 482.734" filter="url(#ficsatr1k5q0d)" style="stroke:#a80036;stroke-width:1.5"/><text x="1196.625" y="498.543" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93">pairing success?</text><text x="1163.625" y="492.14" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21">yes</text><text x="1301.625" y="492.14" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14">no</text><rect width="352" height="33.969" x="801" y="516.734" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="815" y="537.873" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="328">SM_EVENT_PAIRING_COMPLETE(ERROR_CODE_SUCCESS)</text><rect width="173" height="33.969" x="890.5" y="570.703" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="904.5" y="591.842" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="149">GATT Client request sent</text><rect width="204" height="33.969" x="875" y="639.672" fill="#23DB2B" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="889" y="660.811" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="180">App receives GATT Response</text><ellipse cx="977" cy="719.641" fill="#FFF" filter="url(#ficsatr1k5q0d)" rx="11" ry="11" style="stroke:#000;stroke-width:1"/><ellipse cx="977" cy="719.641" fill="#000" rx="6" ry="6" style="stroke:#7f7f7f;stroke-width:1"/><rect width="243" height="33.969" x="1387.75" y="516.734" fill="#FEFECE" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="1401.75" y="537.873" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="219">SM_EVENT_PAIRING_COMPLETE(error)</text><polygon fill="#FEFECE" points="1478.25 570.703 1540.25 570.703 1552.25 582.703 1540.25 594.703 1478.25 594.703 1466.25 582.703 1478.25 570.703" filter="url(#ficsatr1k5q0d)" style="stroke:#a80036;stroke-width:1.5"/><text x="1478.25" y="586.511" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="62">level &gt;= 3</text><text x="1445.25" y="580.109" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21">yes</text><text x="1552.25" y="580.109" fill="#000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14">no</text><rect width="322" height="47.938" x="1183" y="604.703" fill="#FD5B41" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="1197" y="625.842" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="267">App receives GATT_QUERY_COMPLETE event</text><text x="1209" y="639.811" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="286">with ATT_ERROR_INSUFFICIENT_AUTHENTICATION</text><ellipse cx="1344" cy="698.641" fill="#FFF" filter="url(#ficsatr1k5q0d)" rx="11" ry="11" style="stroke:#000;stroke-width:1"/><ellipse cx="1344" cy="698.641" fill="#000" rx="6" ry="6" style="stroke:#7f7f7f;stroke-width:1"/><rect width="299" height="47.938" x="1525" y="604.703" fill="#FD5B41" filter="url(#ficsatr1k5q0d)" rx="12.5" ry="12.5" style="stroke:#a80036;stroke-width:1.5"/><text x="1539" y="625.842" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="267">App receives GATT_QUERY_COMPLETE event</text><text x="1551" y="639.811" fill="#000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="259">with ATT_ERROR_INSUFFICIENT_ENCRYPTION;</text><ellipse cx="1674.5" cy="698.641" fill="#FFF" filter="url(#ficsatr1k5q0d)" rx="11" ry="11" style="stroke:#000;stroke-width:1"/><ellipse cx="1674.5" cy="698.641" fill="#000" rx="6" ry="6" style="stroke:#7f7f7f;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="821.563" x2="821.563" y1="50.953" y2="70.953"/><polygon fill="#A80036" points="817.563 60.953 821.563 70.953 825.563 60.953 821.563 64.953" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="821.563" x2="821.563" y1="104.922" y2="124.922"/><polygon fill="#A80036" points="817.563 114.922 821.563 124.922 825.563 114.922 821.563 118.922" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="821.563" x2="821.563" y1="158.891" y2="178.891"/><polygon fill="#A80036" points="817.563 168.891 821.563 178.891 825.563 168.891 821.563 172.891" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="821.563" x2="821.563" y1="212.859" y2="232.859"/><polygon fill="#A80036" points="817.563 222.859 821.563 232.859 825.563 222.859 821.563 226.859" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="400" x2="400" y1="354.797" y2="374.797"/><polygon fill="#A80036" points="396 364.797 400 374.797 404 364.797 400 368.797" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="400" x2="400" y1="408.766" y2="428.766"/><polygon fill="#A80036" points="396 418.766 400 428.766 404 418.766 400 422.766" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="207.5" x2="207.5" y1="550.703" y2="570.703"/><polygon fill="#A80036" points="203.5 560.703 207.5 570.703 211.5 560.703 207.5 564.703" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="207.5" x2="207.5" y1="604.672" y2="639.672"/><polygon fill="#A80036" points="203.5 629.672 207.5 639.672 211.5 629.672 207.5 633.672" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="207.5" x2="207.5" y1="673.641" y2="708.641"/><polygon fill="#A80036" points="203.5 698.641 207.5 708.641 211.5 698.641 207.5 702.641" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="592.5" x2="592.5" y1="550.703" y2="570.703"/><polygon fill="#A80036" points="588.5 560.703 592.5 570.703 596.5 560.703 592.5 564.703" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="592.5" x2="592.5" y1="618.641" y2="653.641"/><polygon fill="#A80036" points="588.5 643.641 592.5 653.641 596.5 643.641 592.5 647.641" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="351" x2="207.5" y1="494.734" y2="494.734"/><line style="stroke:#a80036;stroke-width:1.5" x1="207.5" x2="207.5" y1="494.734" y2="516.734"/><polygon fill="#A80036" points="203.5 506.734 207.5 516.734 211.5 506.734 207.5 510.734" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="449" x2="592.5" y1="494.734" y2="494.734"/><line style="stroke:#a80036;stroke-width:1.5" x1="592.5" x2="592.5" y1="494.734" y2="516.734"/><polygon fill="#A80036" points="588.5 506.734 592.5 516.734 596.5 506.734 592.5 510.734" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="400" x2="400" y1="462.734" y2="482.734"/><polygon fill="#A80036" points="396 472.734 400 482.734 404 472.734 400 476.734" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1243.125" x2="1243.125" y1="354.797" y2="374.797"/><polygon fill="#A80036" points="1239.125 364.797 1243.125 374.797 1247.125 364.797 1243.125 368.797" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1243.125" x2="1243.125" y1="408.766" y2="428.766"/><polygon fill="#A80036" points="1239.125 418.766 1243.125 428.766 1247.125 418.766 1243.125 422.766" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="977" x2="977" y1="550.703" y2="570.703"/><polygon fill="#A80036" points="973 560.703 977 570.703 981 560.703 977 564.703" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="977" x2="977" y1="604.672" y2="639.672"/><polygon fill="#A80036" points="973 629.672 977 639.672 981 629.672 977 633.672" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="977" x2="977" y1="673.641" y2="708.641"/><polygon fill="#A80036" points="973 698.641 977 708.641 981 698.641 977 702.641" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1344" x2="1344" y1="652.641" y2="687.641"/><polygon fill="#A80036" points="1340 677.641 1344 687.641 1348 677.641 1344 681.641" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1674.5" x2="1674.5" y1="652.641" y2="687.641"/><polygon fill="#A80036" points="1670.5 677.641 1674.5 687.641 1678.5 677.641 1674.5 681.641" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1466.25" x2="1344" y1="582.703" y2="582.703"/><line style="stroke:#a80036;stroke-width:1.5" x1="1344" x2="1344" y1="582.703" y2="604.703"/><polygon fill="#A80036" points="1340 594.703 1344 604.703 1348 594.703 1344 598.703" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1552.25" x2="1674.5" y1="582.703" y2="582.703"/><line style="stroke:#a80036;stroke-width:1.5" x1="1674.5" x2="1674.5" y1="582.703" y2="604.703"/><polygon fill="#A80036" points="1670.5 594.703 1674.5 604.703 1678.5 594.703 1674.5 598.703" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1509.25" x2="1509.25" y1="550.703" y2="570.703"/><polygon fill="#A80036" points="1505.25 560.703 1509.25 570.703 1513.25 560.703 1509.25 564.703" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1184.625" x2="977" y1="494.734" y2="494.734"/><line style="stroke:#a80036;stroke-width:1.5" x1="977" x2="977" y1="494.734" y2="516.734"/><polygon fill="#A80036" points="973 506.734 977 516.734 981 506.734 977 510.734" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1301.625" x2="1509.25" y1="494.734" y2="494.734"/><line style="stroke:#a80036;stroke-width:1.5" x1="1509.25" x2="1509.25" y1="494.734" y2="516.734"/><polygon fill="#A80036" points="1505.25 506.734 1509.25 516.734 1513.25 506.734 1509.25 510.734" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="1243.125" x2="1243.125" y1="462.734" y2="482.734"/><polygon fill="#A80036" points="1239.125 472.734 1243.125 482.734 1247.125 472.734 1243.125 476.734" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="768.563" x2="400" y1="298.828" y2="298.828"/><line style="stroke:#a80036;stroke-width:1.5" x1="400" x2="400" y1="298.828" y2="320.828"/><polygon fill="#A80036" points="396 310.828 400 320.828 404 310.828 400 314.828" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="874.563" x2="1243.125" y1="298.828" y2="298.828"/><line style="stroke:#a80036;stroke-width:1.5" x1="1243.125" x2="1243.125" y1="298.828" y2="320.828"/><polygon fill="#A80036" points="1239.125 310.828 1243.125 320.828 1247.125 310.828 1243.125 314.828" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1.5" x1="821.563" x2="821.563" y1="266.828" y2="286.828"/><polygon fill="#A80036" points="817.563 276.828 821.563 286.828 825.563 276.828 821.563 280.828" style="stroke:#a80036;stroke-width:1"/></g></svg>